<!DOCTYPE html>
<!--[if lt IE 8 ]><html class="no-js ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="no-js ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 8)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
    <!--- basic page needs -->
    <meta charset="utf-8">
    <title>travelapp</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- mobile specific metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- css -->
    <link rel="stylesheet" href="css/default.css">
    <link rel="stylesheet" href="css/style.css">
    <link href="css/prism.css" rel="stylesheet">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/animate.css">
    <!-- script -->
    <script src="js/modernizr.js"></script>
    <!-- favicons -->
    <link rel="shortcut icon" href="images/qacg.ico">
</head>

<body>
    <!-- preloader -->
    <div id="preloader">
        <div class="loader"></div>
    </div>
    <!--preloader end-->
    <!-- header section -->
    <header id="home">
        <nav id="m-nav">
            <a class="mobile-btn" href="#m-nav" title="Show navigation">Show navigation</a>
            <a class="mobile-btn" href="#" title="Hide navigation">Hide navigation</a>
            <ul id="nav" class="nav">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="index.html#agenda">Temario</a></li>
                <li><a href="session-one.html">Sesión # 1</a></li>
                <li class="current"><a href="#">Sesión # 2</a></li>
                <li><a href="session-three.html">Sesión # 3</a></li>
                <li><a href="session-four.html">Sesión # 4</a></li>
            </ul>
        </nav>
        <div class="row banner">
            <div class="banner-text">
                <h1 class="responsive-headline wow zoomIn">MVP, Fragments & Recycler View</h1>
                <h3 class="wow fadeInUp">
                    Sesión # 2
                    <br>
                    <br>
                    Quality & Knowledge on IT Services
                    <br>

                </h3>
            </div>
        </div>
        <p class="scrolldown">
            <a class="smoothscroll" href="#about"><i class="fa fa-angle-double-down"></i></a>
        </p>
        <div class="header-overlay"></div>
    </header>
    <!-- header end -->
    <section id="agenda">
        <h1 class="section-title wow fadeInDown">PATRÓN MVP
        </h1>
        <div class="header-col content-header">
            <h2><span>MVP - Model View Presenter</span></h2>
        </div>

        <div class="row education">
            <p>El patrón de diseño <span>MVP</span> o Model View Presenter <span>separa la capa de presentación de la lógica de la aplicación</span>, por ende, su objetivo es que todo lo relacionado con cómo funciona la interfaz de usuario este separado del cómo representarlo en pantalla.
            </p>

            <p>Se dividen en:<br />
                <span>Model - </span>Contiene cada una de las clases que representan a una entidad dentro de nuestra aplicación.<br />
                <span>View - </span>Esta capa esta compuesta por interfaces, donde cada una definirá los métodos o acciones que se requieren notificar al usuario.<br />
                <span>Presentador - </span>Clases que se encargan de actuar como intermediario entre la vista y el modelo. Esta capa puede o no conocer directamente el origen de los datos (dependiendo si nuestra aplicación cuenta con alguna capa de servicios), pero no debe conocer los componentes gráficos desde donde se le esta invocando.
            </p>
        </div>

        <div class="header-col content-header">
            <h2><span>Implementación de MVP - Autenticación de usuario</span></h2>
        </div>
        <div class="row education">
            <p> Vamos a implementar la arquitectura MVP en el proceso de autenticación de usuario. Para ello ejecutemos los siguientes pasos:</p>

            <p>1 - Incorporemos la clase <span>User.java</span> para representar nuestro <span>modelo</span> Usuario</p>
            <pre><code class="language-java">
            <script type="prism-java">
package com.qacg.travelapp.models;

/**
 * Modelo que representa al usuario de la aplicación.
 */
public class User {
    private String userName;
    private String password;

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }
}
           </script>
            </code> 
        </pre>

            <p>2 - Definamos la capa <span>view</span> declarando una interfaz que contengan los métodos para notificar al usuario el resultado de la operación:</p>
            <pre><code class="language-java">
            <script type="prism-java">
package com.qacg.travelapp.views;

import com.qacg.travelapp.models.User;

/**
 * Vista que define el comportamiento de la vista.
 */
public interface ILoginView {
    void userFound(User user);

    void userNotFound();

    void emptyFields();
}
            </script>
            </code> 
        </pre>

            <p>3 - Declaramos la clase <span>LoginPresenter.java</span>. Esta clase deberá recibir en el constructor un objeto de tipo vista y definara el método para validar el usuario:</p>
            <pre><code class="language-java">
            <script type="prism-java">
package com.qacg.travelapp.presents;

import com.qacg.travelapp.models.User;
import com.qacg.travelapp.views.ILoginView;

public class LoginPresenter {

    private ILoginView view;

    public LoginPresenter(ILoginView view) {
        this.view = view;
    }

    public void validateUser(String username, String password) {
        if (username.length() == 0 || password.length() == 0) {
            view.emptyFields();
        } else if (username.equals("android") && password.equals("apps")) {
            User user = new User();
            user.setUserName(username);
            user.setPassword(password);
            view.userFound(user);
        } else {
            view.userNotFound();
        }
    }
}             </script>
            </code> 
        </pre>


            <strong>Enlazando las capas del patrón MVP</strong>

            <p>
                Para lograr la comunicación entre las 3 capas vamos a realizar los siguientes pasos:
            </p>
            <p>
                4 - La clase <span>LoginActivity.java</span> implementará la interfaz <span>ILoginView.java</span> de la siguiente manera:
            </p>
            <pre><code class="language-java">
            <script type="prism-java">
package com.qacg.travelapp;

import android.content.DialogInterface;
import android.content.Intent;
import android.support.v7.app.AlertDialog;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

import com.qacg.travelapp.models.User;
import com.qacg.travelapp.presents.LoginPresenter;
import com.qacg.travelapp.views.ILoginView;

public class LoginActivity extends AppCompatActivity implements ILoginView {
    
    private LoginPresenter presenter;

    private TextView txtUsername;
    private TextView txtPassword;
    private Button btnLogin;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_login);
        init();
    }

    private void init() {
        presenter = new LoginPresenter(this);
        txtUsername = findViewById(R.id.txtUsername);
        txtPassword = findViewById(R.id.txtPassword);

        btnLogin = findViewById(R.id.btnLogin);
        btnLogin.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
               validateUser();
            }
        });
    }
    
   private void validateUser() {
        String username = txtUsername.getText().toString();
        String password = txtPassword.getText().toString();

        if (username.length() == 0 || password.length() == 0) {
            final AlertDialog.Builder builder = new AlertDialog.Builder(this, R.style.LightDialogTheme);
            builder.setTitle(R.string.app_name);
            builder.setMessage(R.string.empty_credentials_msg);
            builder.setPositiveButton(R.string.accept_bnt, new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                    dialog.dismiss();
                }
            });
            AlertDialog dialog = builder.create();
            dialog.show();
            return;
        }

        if (username.equals("android") && password.equals("apps")) {
            startActivity(new Intent(this, MainActivity.class));
            finish();
        } else {
            final AlertDialog.Builder builder = new AlertDialog.Builder(this, R.style.LightDialogTheme);
            builder.setTitle(R.string.app_name);
            builder.setMessage(R.string.not_user_found_msg);
            builder.setPositiveButton(R.string.accept_bnt, new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                    dialog.dismiss();
                }
            });
            AlertDialog dialog = builder.create();
            dialog.show();
            return;
        }
    }

    @Override
    public void userFound(User user) {
    }

    @Override
    public void userNotFound() {
    }

    @Override
    public void emptyFields() {
    }
}
           </script>
            </code> 
        </pre>


            <p>
                Así definimos como nuestro <span>View</span> la clase <span>LoginActivity.java</span> <br />

                5 - La clase <span>LoginActivity.java</span> declarará una variable de tipo <span>LoginPresenter.java</span> para notificar las interacciones del usuario con la interfaz:
            </p>

            <pre><code class="language-java">
            <script type="prism-java">
package com.qacg.travelapp;

import android.content.DialogInterface;
import android.content.Intent;
import android.support.v7.app.AlertDialog;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

import com.qacg.travelapp.models.User;
import com.qacg.travelapp.presents.LoginPresenter;
import com.qacg.travelapp.views.ILoginView;

public class LoginActivity extends AppCompatActivity implements ILoginView {

    private LoginPresenter presenter;

    private TextView txtUsername;
    private TextView txtPassword;
    private Button btnLogin;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_login);
        init();
    }

    private void init() {
        presenter = new LoginPresenter(this);
        txtUsername = findViewById(R.id.txtUsername);
        txtPassword = findViewById(R.id.txtPassword);

        btnLogin = findViewById(R.id.btnLogin);
        btnLogin.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                presenter.validateUser(txtUsername.getText().toString(), txtPassword.getText().toString());
            }
        });
    }

    @Override
    public void userFound(User user) {
        startActivity(new Intent(this, MainActivity.class));
        finish();
    }

    @Override
    public void userNotFound() {
        final AlertDialog.Builder builder = new AlertDialog.Builder(this, R.style.LightDialogTheme);
        builder.setTitle(R.string.app_name);
        builder.setMessage(R.string.not_user_found_msg);
        builder.setPositiveButton(R.string.accept_bnt, new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int id) {
                dialog.dismiss();
            }
        });
        AlertDialog dialog = builder.create();
        dialog.show();
    }

    @Override
    public void emptyFields() {
        final AlertDialog.Builder builder = new AlertDialog.Builder(this, R.style.LightDialogTheme);
        builder.setTitle(R.string.app_name);
        builder.setMessage(R.string.empty_credentials_msg);
        builder.setPositiveButton(R.string.accept_bnt, new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int id) {
                dialog.dismiss();
            }
        });
        AlertDialog dialog = builder.create();
        dialog.show();
    }
}
            </script>
            </code> 
        </pre>
            <span style="color: #e91e63;">It's time to run the project & test it</span>
        </div>
    </section>

    <section id="agenda" style="padding-bottom: 0px !important; padding-top: 0px !important; margin-top: -40px;">
        <h1 class="section-title wow fadeInDown">FRAGMENTS & FRAGMENT MANAGER
        </h1>
        <div class="row education">
            <p>Un Fragment representa un comportamiento o una parte de la interfaz de usuario en una Activity. Puedes combinar múltiples fragmentos en una sola actividad para crear una IU multipanel y volver a usar un fragmento en múltiples actividades. Puedes pensar en un fragmento como una sección modular de una actividad que tiene su ciclo de vida propio, recibe sus propios eventos de entrada y que puedes agregar o quitar mientras la actividad se esté ejecutando (algo así como una "subactividad" que puedes volver a usar en diferentes actividades).
            </p>

            <p>La siguiente imagen es un ejemplo de la manera en que dos módulos de la IU definidos por fragmentos se pueden combinar en una actividad para un diseño de tablet y se presentan por separado para un diseño de teléfono.</p>

            <img src="https://developer.android.com/images/fundamentals/fragments.png" />
        </div>
        <div class="header-col content-header">
            <h2><span>Implementación de Fragmentos</span></h2>
        </div>

        <div class="row education">
            <p>
                Para crear un fragmento realizaremos los siguientes pasos:<br />

                1 - Crear un paquete especial para los fragmentos. <br />
                2 - Click derecho sobre el paquete > New > Fragment > Fragment Blank.<br />
                3 - En el dialogo ingresaremos los datos necesarios.<br />
                4 - Realizaremos un patrón Singleto para obtener una instancia del fragmento:
            </p>
            <pre><code class="language-java">
            <script type="prism-java">
package com.qacg.travelapp.fragments;


import android.os.Bundle;
import android.support.annotation.NonNull;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

import com.qacg.travelapp.R;

/**
 * Fragmento que muestra la lista de lugares.
 */
public class PlacesFragment extends Fragment {

    private static PlacesFragment instance;

    public static PlacesFragment getInstance() {
        if (instance == null) {
            instance = new PlacesFragment();
        }
        return instance;
    }

    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        return inflater.inflate(R.layout.fragment_places, container, false);
    }

}   
            </script>
            </code> 
        </pre>

            <p>Agregando el fragmento a una actividad</p>

            <p>5 - Modificar el layout para recibir el fragmento:</p>
            <pre><code class="language-markup"><script type="prism-markup">
<?xml version="1.0" encoding="utf-8"?>
<android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity">

    <FrameLayout
        android:id="@+id/mainFragment"
        android:layout_width="0dp"
        android:layout_height="0dp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" />
</android.support.constraint.ConstraintLayout>
            </script></code></pre>


            <p> Y por ultimo:<br />
                6 - Cargar el fragmento desde el <span>MainActivity.java</span>
            </p>
            <pre><code class="language-java">
            <script type="prism-java">
package com.qacg.travelapp;

import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v7.app.AppCompatActivity;

import com.qacg.travelapp.fragments.PlacesFragment;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        if (false) {
            startActivity(new Intent(this, WelcomeActivity.class));
            finish();
        } else {
            loadFragment(R.id.mainFragment,PlacesFragment.getInstance());
        }
    }

    private void loadFragment(int idReplace,Fragment fragment) {
        getSupportFragmentManager()
                .beginTransaction()
                .replace(idReplace, fragment)
                .commit();
    }
}
</script></code></pre>
        </div>
    </section>

    <!-- footer -->
    <footer>
        <div class="row wow fadeInUp" style="color: white;">
            <div class="twelve columns">
                <span>Quality & Knowledge on IT Services | 2018 | Ciudad de México</span>
                <ul class="social-links">
                    <li><i class="fab fa-android"></i></li>
                </ul>
                Alejandro Salazar | Gerardo Epitacio | Víctor Hernández
            </div>
            <div id="go-top"><a class="smoothscroll" title="Back to Top" href="#home"><i class="fa fa-chevron-up"></i></a></div>
        </div>
    </footer>
    <!-- footer end-->
    <!-- java script -->
    <script src="js/jquery-2.1.1.min.js"></script>
    <script src="js/waypoints.js"></script>
    <script src="js/jquery.fittext.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/prism.js"></script>
    <script src="js/jquery.nicescroll.min.js"></script>
    <script src="js/script.js"></script>
</body>

</html>
